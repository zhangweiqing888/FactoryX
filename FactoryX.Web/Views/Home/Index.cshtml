@model FactoryX.Web.Models.DashboardViewModel
@{
    ViewData["Title"] = "仪表板";
}
<div class="container">
    <h1 class="fw-bold mb-4 text-center">MES 仪表板</h1>
    <div class="row g-4 mb-5">
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card glass-card text-center shadow-sm">
                <div class="card-body">
                    <div class="display-6 mb-2"><i class="bi bi-cpu text-primary"></i></div>
                    <div class="fs-4 fw-bold">@Model.MachineCount</div>
                    <div class="small text-muted">机器</div>
                </div>
                <div class="card-footer bg-transparent border-0 d-flex justify-content-center gap-3 py-2">
                    <a asp-controller="Machines" asp-action="Index" class="icon-link" data-bs-toggle="tooltip"
                        title="查看全部">
                        <i class="bi bi-eye fs-4 text-primary"></i>
                    </a>
                    <a asp-controller="Machines" asp-action="Create" class="icon-link" data-bs-toggle="tooltip"
                        title="新增">
                        <i class="bi bi-plus-circle fs-4 text-success"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card glass-card text-center shadow-sm">
                <div class="card-body">
                    <div class="display-6 mb-2"><i class="bi bi-box-seam text-success"></i></div>
                    <div class="fs-4 fw-bold">@Model.ProductCount</div>
                    <div class="small text-muted">产品</div>
                </div>
                <div class="card-footer bg-transparent border-0 d-flex justify-content-center gap-3 py-2">
                    <a asp-controller="Products" asp-action="Index" class="icon-link" data-bs-toggle="tooltip"
                        title="查看全部">
                        <i class="bi bi-eye fs-4 text-primary"></i>
                    </a>
                    <a asp-controller="Products" asp-action="Create" class="icon-link" data-bs-toggle="tooltip"
                        title="新增">
                        <i class="bi bi-plus-circle fs-4 text-success"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card glass-card text-center shadow-sm">
                <div class="card-body">
                    <div class="display-6 mb-2"><i class="bi bi-person-badge text-info"></i></div>
                    <div class="fs-4 fw-bold">@Model.OperatorCount</div>
                    <div class="small text-muted">操作员</div>
                </div>
                <div class="card-footer bg-transparent border-0 d-flex justify-content-center gap-3 py-2">
                    <a asp-controller="Operator" asp-action="Index" class="icon-link" data-bs-toggle="tooltip"
                        title="查看全部">
                        <i class="bi bi-eye fs-4 text-primary"></i>
                    </a>
                    <a asp-controller="Operator" asp-action="Create" class="icon-link" data-bs-toggle="tooltip"
                        title="新增">
                        <i class="bi bi-plus-circle fs-4 text-success"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card glass-card text-center shadow-sm">
                <div class="card-body">
                    <div class="display-6 mb-2"><i class="bi bi-list-task text-warning"></i></div>
                    <div class="fs-4 fw-bold">@Model.WorkOrderCount</div>
                    <div class="small text-muted">工单</div>
                </div>
                <div class="card-footer bg-transparent border-0 d-flex justify-content-center gap-3 py-2">
                    <a asp-controller="WorkOrder" asp-action="Index" class="icon-link" data-bs-toggle="tooltip"
                        title="查看全部">
                        <i class="bi bi-eye fs-4 text-primary"></i>
                    </a>
                    <a asp-controller="WorkOrder" asp-action="Create" class="icon-link" data-bs-toggle="tooltip"
                        title="新增">
                        <i class="bi bi-plus-circle fs-4 text-success"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card glass-card text-center shadow-sm">
                <div class="card-body">
                    <div class="display-6 mb-2"><i class="bi bi-clipboard-data text-danger"></i></div>
                    <div class="fs-4 fw-bold">@Model.ProductionRecordCount</div>
                    <div class="small text-muted">生产记录</div>
                </div>
                <div class="card-footer bg-transparent border-0 d-flex justify-content-center gap-3 py-2">
                    <a asp-controller="ProductionRecord" asp-action="Index" class="icon-link" data-bs-toggle="tooltip"
                        title="查看全部">
                        <i class="bi bi-eye fs-4 text-primary"></i>
                    </a>
                    <a asp-controller="ProductionRecord" asp-action="Create" class="icon-link" data-bs-toggle="tooltip"
                        title="新增">
                        <i class="bi bi-plus-circle fs-4 text-success"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="col-6 col-md-4 col-lg-2">
            <div class="card glass-card text-center shadow-sm">
                <div class="card-body">
                    <div class="display-6 mb-2"><i class="bi bi-clock-history text-secondary"></i></div>
                    <div class="fs-4 fw-bold">@Model.ShiftCount</div>
                    <div class="small text-muted">班次</div>
                </div>
                <div class="card-footer bg-transparent border-0 d-flex justify-content-center gap-3 py-2">
                    <a asp-controller="Shift" asp-action="Index" class="icon-link" data-bs-toggle="tooltip"
                        title="查看全部">
                        <i class="bi bi-eye fs-4 text-primary"></i>
                    </a>
                    <a asp-controller="Shift" asp-action="Create" class="icon-link" data-bs-toggle="tooltip"
                        title="新增">
                        <i class="bi bi-plus-circle fs-4 text-success"></i>
                    </a>
                </div>
            </div>
        </div>
    </div>
    <div class="row g-4">
        <div class="col-lg-6">
            <div class="card glass-card shadow-sm h-100">
                <div class="card-header bg-transparent fw-bold d-flex justify-content-between align-items-center">
                    <span>最近工单</span>
                    <span>
                        <a asp-controller="WorkOrder" asp-action="Index"
                            class="btn btn-sm btn-outline-primary me-1">查看全部</a>
                        <a asp-controller="WorkOrder" asp-action="Create" class="btn btn-sm btn-primary">新增</a>
                    </span>
                </div>
                <div class="card-body p-0">
                    <table class="table table-sm align-middle mb-0">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>产品</th>
                                <th>机器</th>
                                <th>数量</th>
                                <th>开始时间</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var wo in Model.RecentWorkOrders)
                            {
                                <tr>
                                    <td>@wo.Id</td>
                                    <td>@wo.ProductName</td>
                                    <td>@wo.MachineName</td>
                                    <td>@wo.Quantity</td>
                                    <td>@wo.StartDate.ToShortDateString()</td>
                                    <td>@wo.Status</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card glass-card shadow-sm h-100">
                <div class="card-header bg-transparent fw-bold d-flex justify-content-between align-items-center">
                    <span>最近生产记录</span>
                    <span>
                        <a asp-controller="ProductionRecord" asp-action="Index"
                            class="btn btn-sm btn-outline-primary me-1">查看全部</a>
                        <a asp-controller="ProductionRecord" asp-action="Create" class="btn btn-sm btn-primary">新增</a>
                    </span>
                </div>
                <div class="card-body p-0">
                    <table class="table table-sm align-middle mb-0">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>工单</th>
                                <th>操作员</th>
                                <th>数量</th>
                                <th>时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var rec in Model.RecentProductionRecords)
                            {
                                <tr>
                                    <td>@rec.Id</td>
                                    <td>@rec.WorkOrderName</td>
                                    <td>@rec.OperatorName</td>
                                    <td>@rec.QuantityProduced</td>
                                    <td>@rec.Timestamp.ToString("g")</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<style>
    .glass-card {
        background: rgba(255, 255, 255, 0.7);
        border-radius: 1rem;
        backdrop-filter: blur(6px);
        transition: box-shadow 0.2s;
    }

    .glass-card:hover {
        box-shadow: 0 0 0.5rem #007bff33;
    }

    [data-bs-theme="dark"] .glass-card {
        background: rgba(30, 30, 40, 0.7);
    }

    .icon-link {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        text-decoration: none;
        transition: transform 0.15s;
    }

    .icon-link:hover {
        transform: scale(1.15);
        opacity: 0.85;
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.forEach(function (tooltipTriggerEl) {
            new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>
